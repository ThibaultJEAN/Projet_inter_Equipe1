Version 4
SHEET 1 1620 1076
WIRE -768 64 -1328 64
WIRE -320 64 -768 64
WIRE -176 64 -320 64
WIRE 64 64 -96 64
WIRE 208 64 64 64
WIRE 368 64 288 64
WIRE 528 64 368 64
WIRE 576 64 528 64
WIRE 720 64 576 64
WIRE 928 64 800 64
WIRE 1184 64 928 64
WIRE 1472 64 1184 64
WIRE 1184 80 1184 64
WIRE 576 96 576 64
WIRE -1328 144 -1328 64
WIRE -320 144 -320 64
WIRE -160 144 -160 112
WIRE 64 144 64 64
WIRE 368 144 368 64
WIRE 1472 144 1472 64
WIRE -768 160 -768 144
WIRE -640 160 -768 160
WIRE -768 176 -768 160
WIRE 1184 176 1184 160
WIRE 1232 176 1184 176
WIRE 1184 192 1184 176
WIRE 576 224 576 176
WIRE 624 224 576 224
WIRE 928 224 928 64
WIRE 928 224 880 224
WIRE -160 256 -160 224
WIRE -112 256 -112 112
WIRE -112 256 -160 256
WIRE -1328 272 -1328 224
WIRE -320 272 -320 208
WIRE -112 272 -112 256
WIRE 64 272 64 208
WIRE 368 272 368 208
WIRE 1472 272 1472 224
WIRE 528 336 528 64
WIRE 624 336 528 336
WIRE 928 336 880 336
WIRE 544 496 512 496
WIRE 624 496 544 496
WIRE 544 512 544 496
WIRE 544 640 544 592
WIRE 928 640 928 336
WIRE 928 640 544 640
WIRE 544 672 544 640
FLAG 64 272 0
FLAG 1472 272 0
FLAG -320 272 0
FLAG -1328 272 0
FLAG -112 272 0
FLAG 368 272 0
FLAG 1472 64 OUT
FLAG -1328 64 IN
FLAG -768 256 0
FLAG -640 160 Vin_mon
FLAG 1184 272 0
FLAG 1232 176 Vout_mon
FLAG 544 672 0
FLAG 512 496 I_mon
SYMBOL ind 192 80 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 47µ
SYMATTR SpiceLine Rser=60m
SYMBOL schottky 80 208 R180
WINDOW 0 24 64 Left 2
WINDOW 3 -66 -2 Left 2
SYMATTR InstName D1
SYMATTR Value MBRB2545CT
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 1456 128 R0
SYMATTR InstName Rch
SYMATTR Value {Rch}
SYMBOL sw -80 64 M270
WINDOW 3 49 103 VLeft 2
SYMATTR Value MYSW
SYMATTR InstName S1
SYMBOL cap -336 144 R0
SYMATTR InstName Cin
SYMATTR Value 47µ
SYMATTR SpiceLine Rser=1
SYMBOL voltage -160 128 R0
WINDOW 3 -166 241 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 0 34 54 Left 2
SYMATTR Value PULSE(-1 1 0 1p 1p {alpha/Fs} {1/Fs})
SYMATTR InstName V1
SYMBOL voltage -1328 128 R0
WINDOW 3 -78 50 Left 2
WINDOW 39 -108 97 Left 2
WINDOW 123 0 0 Left 2
SYMATTR Value {Vin}
SYMATTR SpiceLine Rser=100m
SYMATTR InstName Vin
SYMBOL cap 352 144 R0
SYMATTR InstName Cout
SYMATTR Value 47µ
SYMATTR SpiceLine Rser=1
SYMBOL res -784 48 R0
SYMATTR InstName R1
SYMATTR Value 100k
SYMBOL res -784 160 R0
SYMATTR InstName R2
SYMATTR Value 6.2k
SYMBOL res 1168 64 R0
SYMATTR InstName R3
SYMATTR Value 100k
SYMBOL res 1168 176 R0
SYMATTR InstName R4
SYMATTR Value 6.2k
SYMBOL res 816 48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rshunt
SYMATTR Value 5m
SYMBOL Opamps\\LTC6101 752 352 M0
SYMATTR InstName U1
SYMBOL res 560 80 R0
SYMATTR InstName R5
SYMATTR Value 100
SYMBOL res 528 496 R0
SYMATTR InstName R6
SYMATTR Value 5k1
TEXT -256 648 Left 2 !.param Fs=100k alpha=.64 Vin=38 Rch=2.5
TEXT -256 856 Left 2 !.tran 0 30m 15m
TEXT -256 672 Left 2 !.model MYSW SW(Ron=100m Roff=1Meg Vt=.5 Vh=0.4)
TEXT -256 752 Left 2 !.meas Pin AVG -V(IN)*I(Vin)\n.meas Pout AVG V(OUT)*I(Rch)\n.meas Eff param Pout/Pin
TEXT -256 720 Left 2 !.meas Irms RMS I(L1)
TEXT -256 832 Left 2 ;.step dec param Rch 2.5 10 10
TEXT -256 696 Left 2 !.meas Vout AVG V(out)
TEXT -1360 1016 Left 2 ;Solar panel
TEXT -800 1024 Left 2 ;Vin sense
TEXT -136 1024 Left 2 ;Buck
TEXT 664 1024 Left 2 ;Iout_sense
TEXT 1112 1032 Left 2 ;Vout_sense
TEXT 1448 1024 Left 2 ;Load
RECTANGLE Normal -1008 1072 -1584 -16 2
RECTANGLE Normal -480 1072 -1008 -16 2
RECTANGLE Normal 448 1072 -480 -16 2
RECTANGLE Normal 1008 1072 448 -16 2
RECTANGLE Normal 1360 1072 1008 -16 2
RECTANGLE Normal 1616 1072 1360 -16 2
